Task: "JointTrainAgent"

BasicSettings:
  Seed: 0
  ImageSize: 64
  ReplayBufferOnGPU: True

JointTrainAgent:
  SampleMaxSteps: 52000
  BufferMaxLength: 50000
  BufferWarmUp: 1024
  NumEnvs: 1
  BatchSize: 16
  DemonstrationBatchSize: 4
  BatchLength: 64
  ImagineBatchSize: 1024
  ImagineDemonstrationBatchSize: 256
  ImagineContextLength: 8
  ImagineBatchLength: 16
  TrainDynamicsEverySteps: 1
  TrainAgentEverySteps: 1
  UseDemonstration: False
  SaveEverySteps: 2000

Models:
  WorldModel:
    InChannels: 3
    TransformerMaxLength: 64
    TransformerHiddenDim: 512
    TransformerNumLayers: 2
    TransformerNumHeads: 8
    # Monotonic increasing masking: testing if range (0-35%) matters more than pattern
    UseProgressiveMasking: True
    UseProgressiveInKVCache: False
    UseMildDecayInKV: False
    # Monotonic increasing strategy (0% to 35% evenly distributed):
    # Head 1: 0%   - Full context access
    # Head 2: 5%   - Near-full context  
    # Head 3: 10%  - Slight temporal focus
    # Head 4: 15%  - Light masking
    # Head 5: 20%  - Moderate masking
    # Head 6: 25%  - Medium masking
    # Head 7: 30%  - Higher masking
    # Head 8: 35%  - Maximum masking (same as specialized)
    FixedMaskPercents: [0.0, 0.05, 0.10, 0.15, 0.20, 0.25, 0.30, 0.35]
    UseRandomMask: False    # Consistent oldest-first masking (same as specialized)
    UseSoftPenalty: False   # Hard boundaries (same as specialized)


  Agent:
    NumLayers: 2
    HiddenDim: 512
    Gamma: 0.985
    Lambda: 0.95
    EntropyCoef: 3E-4

  NoveltyDetection:
    Enabled: True
    HistoryLength: 100
    DetectionThresholdPercentile: 95.0
    MinSamplesForDetection: 50
    EnableAdaptiveThreshold: True
    EIGThreshold: 0.0
    UseEIGPrimary: True
    LogDetections: True
    SaveDetectionLog: True
    DetectionLogPath: "detection_logs/"

NoveltyTesting:
  Enabled: False
  NoveltyType: "visual_noise"
