Task: "JointTrainAgent"

BasicSettings:
  Seed: 0
  ImageSize: 64
  ReplayBufferOnGPU: True

JointTrainAgent:
  SampleMaxSteps: 25000  # Reduced from 102000 to 25k
  BufferMaxLength: 20000  # Reduced proportionally  
  BufferWarmUp: 1024
  NumEnvs: 1
  BatchSize: 16
  DemonstrationBatchSize: 4
  BatchLength: 64
  ImagineBatchSize: 1024
  ImagineDemonstrationBatchSize: 256
  ImagineContextLength: 8
  ImagineBatchLength: 16
  TrainDynamicsEverySteps: 1
  TrainAgentEverySteps: 1
  UseDemonstration: False
  SaveEverySteps: 1250  # Save every 5% of total steps

Models:
  WorldModel:
    InChannels: 3
    TransformerMaxLength: 64
    TransformerHiddenDim: 512
    TransformerNumLayers: 2
    TransformerNumHeads: 8
    # progressive masking - keep same as STORM but disable KV cache masking
    UseProgressiveMasking: True
    UseProgressiveInKVCache: False  # DISABLED to prevent double masking
    UseMildDecayInKV: False         # Not needed since KV masking is disabled

  Agent:
    NumLayers: 2
    HiddenDim: 512
    Gamma: 0.985
    Lambda: 0.95
    EntropyCoef: 3E-4

  NoveltyDetection:
    Enabled: False  # Disabled for faster training 