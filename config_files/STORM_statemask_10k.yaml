Task: "JointTrainAgent"

BasicSettings:
  Seed: 42
  ImageSize: 64
  ReplayBufferOnGPU: True

JointTrainAgent:
  SampleMaxSteps: 75000
  BufferMaxLength: 75000
  BufferWarmUp: 1024
  NumEnvs: 1
  BatchSize: 16
  DemonstrationBatchSize: 4
  BatchLength: 64
  ImagineBatchSize: 1024
  ImagineDemonstrationBatchSize: 256
  ImagineContextLength: 8
  ImagineBatchLength: 16
  TrainDynamicsEverySteps: 1
  TrainAgentEverySteps: 1
  UseDemonstration: False
  SaveEverySteps: 5000

Models:
  WorldModel:
    InChannels: 3
    TransformerMaxLength: 64
    TransformerHiddenDim: 512
    TransformerNumLayers: 2
    TransformerNumHeads: 8
    UseProgressiveMasking: True
    UseProgressiveInKVCache: False
    UseMildDecayInKV: False
    FixedMaskPercents: [0.0, 0.0357, 0.0714, 0.1071, 0.1429, 0.1786, 0.2143, 0.25]
    UseRandomMask: True
    UseSoftPenalty: False

  Agent:
    NumLayers: 2
    HiddenDim: 512
    Gamma: 0.985
    Lambda: 0.95
    EntropyCoef: 3E-4

  StateMask:
    Enabled: True
    HiddenDim: 128
    LR: 1e-4
    SparsityWeight: 0.1
    TargetSparsity: 0.3
    TrainFrequency: 750
    WarmupSteps: 10000

  NoveltyDetection:
    Enabled: False
    HistoryLength: 100
    DetectionThresholdPercentile: 95.0
    MinSamplesForDetection: 50
    EnableAdaptiveThreshold: True
    EIGThreshold: 0.0
    UseEIGPrimary: True
    LogDetections: True
    SaveDetectionLog: True
    DetectionLogPath: "detection_logs/"

NoveltyTesting:
  Enabled: False
  NoveltyType: "visual_noise"
  NoveltyParams:
    noise_std: 30.0
    shift_type: "red"
    mask_ratio: 0.3
    kernel_size: 15
    angle: 15.0
  NoveltyStartStep: 100


